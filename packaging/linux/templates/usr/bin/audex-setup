#!/bin/bash
# Audex Setup Wizard

set -e

readonly AUDEX_VENV="/usr/lib/audex/venv"
readonly SYSTEM_CONFIG="/etc/audex/config.system.yml"
readonly USER_CONFIG="$HOME/.config/audex/config.yml"

# Check virtual environment
if [ ! -f "$AUDEX_VENV/bin/activate" ]; then
    echo "❌ Error: Virtual environment not found"
    exit 1
fi

# Check system config
if [ ! -f "$SYSTEM_CONFIG" ]; then
    echo "❌ Error: System configuration not found: $SYSTEM_CONFIG"
    exit 1
fi

# Activate venv and run setup
source "$AUDEX_VENV/bin/activate"

exec python3 -m audex init setup \
    --config "$SYSTEM_CONFIG" \
    --output "$USER_CONFIG"
